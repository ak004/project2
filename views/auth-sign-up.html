


<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <title>Webkit | Responsive Bootstrap 4 Admin Dashboard Template</title>
      
      <!-- Favicon -->
      <link rel="shortcut icon" href="images/favicon.ico" />
      <link rel="stylesheet" href="css/backend-plugin.min.css">
      <link rel="stylesheet" href="css/backend.css?v=1.0.0">
      <link rel="stylesheet" href="vendor/line-awesome/dist/line-awesome/css/line-awesome.min.css">
      <link rel="stylesheet" href="vendor/remixicon/fonts/remixicon.css">
      
      <link rel="stylesheet" href="vendor/tui-calendar/tui-calendar/dist/tui-calendar.css">
      <link rel="stylesheet" href="vendor/tui-calendar/tui-date-picker/dist/tui-date-picker.css">
      <link rel="stylesheet" href="vendor/tui-calendar/tui-time-picker/dist/tui-time-picker.css">  </head>
  <body class=" ">
    <!-- loader Start -->
 
    <!-- loader END -->
    
      <div class="wrapper">
      <section class="login-content">
         <div class="container">
            <div class="row align-items-center justify-content-center height-self-center">
               <div class="col-lg-8">
                  <div class="card auth-card">
                     <div class="card-body p-0">
                        <div class="d-flex align-items-center auth-content">
                           <div class="col-lg-6 bg-primary content-left">
                              <div class="p-3">
                                 <center>
                                    <h2 class="mb-2 text-white">Sign Up</h2>
                                    <p>Create your account.</p>
                                 </center>
                           

                                 <form id="signupSimad" name="signupSimad" method="post">
                                    <div class="row">
                                       <div class="row"  id="email_div">
                                          <div class="col-lg-12">
                                             <div class="floating-label form-group">
                                                <input class="floating-input form-control" id="Semail" name="Semail" type="email" placeholder=" " required>
                                                <label>Simad Email</label>
                                             </div>
                                          </div>
                                          <div class="col-lg-12">
                                             <center>
                                                <button type="button" style="width: 50%;" class="btn btn-white" id="signup_btn" onclick="check_and_send_Verfication()">Next</button>
                                             </center>
                                          </div>
                                       </div>
                                       <div class="row"  id="verifcation_div" style="display: none;" >
                                          <div class="col-lg-12">
                                             <div class="floating-label form-group">
                                                <input class="floating-input form-control" id="ver_code" name="ver_code" type="number" maxlength="6" minlength="6" placeholder=" " required>
                                                <label>Verification Code</label>
                                             </div>
                                          </div>
                                          <div class="col-lg-12">
                                             <p style="color: white; text-align: center;" id="messageee"> We send you a verfication code to your email please check if there is no email please check your spam box</p>
                                          </div>
                                          <div class="col-lg-12">
                                             <center>
                                                <button type="button" style="width: 50%;" class="btn btn-white" id="signup_btn" onclick="confrim_verfication()">Confirm</button>
                                             </center>
                                          </div>
                                       </div>

                                       <div class="row"  id="regiser_form_div"  style="display: none;" >
                                          <form id="signup" name="signup" method="POST"   >
                                             <input type="hidden" id="email" name="email">
                                             <input type="hidden" id="conf_ver_code" name="conf_ver_code">
                                             <div class="row">
                                                <div class="col-lg-12" >
                                                   <div class="floating-label form-group" style="margin-left: 20px; margin-right: 40px;">
                                                      <input class="floating-input form-control" id="full_name" name="full_name" type="text" placeholder=" " required>
                                                      <label>First Name</label>
                                                   </div>
                                                </div>
                                                <div class="col-lg-12">
                                                   <div class="floating-label form-group" style="margin-left: 20px; margin-right: 40px;">
                                                      <input class="floating-input form-control" type="text" id="phone_number" name="phone_number" placeholder=" " required>
                                                      <label>Phone No.</label>
                                                   </div>
                                                </div>
                                               
                                                <div class="col-lg-12">
                                                   <div class="floating-label form-group" style="margin-left: 20px; margin-right: 40px;">
                                                      <input class="floating-input form-control" type="text" placeholder=" " id="username" name="username" required >
                                                      <label>Username</label>
                                                   </div>
                                                </div>
                                                <div class="col-lg-12">
                                                   <div class="floating-label form-group" style="margin-left: 20px; margin-right: 40px;">
                                                      <input class="floating-input form-control" type="password" id="password" name="password" placeholder=" " required>
                                                      <label>Password</label>
                                                   </div>
                                                </div>
                                                <div class="col-lg-12">
                                                   <div class="floating-label form-group" style="margin-left: 20px; margin-right: 40px;">
                                                      <input class="floating-input form-control" type="password"   id="Cpassword" name="Cpassword"  placeholder=" " required>
                                                      <label>Confirm Password</label>
                                                   </div>
                                                </div>
                                            
                                             </div>
                                             <button type="button" class="btn btn-white" id="signup_btn" style="width: 100%; margin-left: 20px; margin-right: 40px;" onclick="Register()">Sign Up</button>
                                            
                                             <p style="color: red;" id="message"> </p>
                                          </form>
                                       </div>

                                     </div>
                                 </form> 

                              </div>
                           </div>
                           <div class="col-lg-6 content-right">
                              <img src="images/login/01.png" class="img-fluid image-right" alt="">
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </section>
      </div>
    
    <!-- Backend Bundle JavaScript -->
    <script src="js/backend-bundle.min.js"></script>
    
    <!-- Table Treeview JavaScript -->
    <script src="js/table-treeview.js"></script>
    
    <!-- Chart Custom JavaScript -->
    <script src="js/customizer.js"></script>
 
    
    <!-- Chart Custom JavaScript -->
    <script async src="js/chart-custom.js"></script>
    <!-- Chart Custom JavaScript -->
    <script async src="js/slider.js"></script>
    
    <!-- app JavaScript -->
    <script src="js/app.js"></script>
    
    <script src="vendor/moment.min.js"></script>



   <script>

      $('#email_div').show();
      $('#verifcation_div').hide();
      $('#regiser_form_div').hide();
       function Register() {
        
     
         var full_name = $('#full_name').val().trim();
         var email = $('#email').val().trim();
         var username = $('#username').val().trim();
         var password = $('#password').val().trim();
         var Cpassword = $('#Cpassword').val().trim();
         var phone_number = $('#phone_number').val().trim();

         if(full_name == undefined || full_name.trim().length <= 3) {
            alert('Please enter a full name');
         }else if(email == undefined || email.trim().length <= 3) {
            alert('Please enter a email  ');
         }else if(username == undefined || username.trim().length <= 3) {
            alert('Please enter a username  ');
         }else if(phone_number == undefined || phone_number.trim().length <= 5) {
            alert('Please enter a phone_number');
         }else if(password == undefined || password.trim().length <= 3) {
            alert('Please enter a phone_number');
         } else if(password != Cpassword) {
            alert('Password dont match');
         }else {
            var whole_data = {}
            whole_data.name = full_name;
            whole_data.email = email;
            whole_data.password = password;
            whole_data.phone = phone_number;
            whole_data.Cpassword = Cpassword;
            whole_data.user_name = username;
            $.ajax({
                type: 'post',
                url: '/signup',
                data: whole_data,
                dataType: "json",
                success: function (res) {
                  console.log(res);
                  if(res.success) {
                     Swal.fire({
                            title: res.message,
                            icon: 'success',
                            confirmButtonText: 'OK',
                        }).then(_ => {
                           window.location.href = "/"
                        })
                  }else {
                  $('#message').append(res.message);
                  }
                }
            });
         }
       }

       function check_and_send_Verfication() {
         let Semail = $('#Semail').val().trim();

         var extention = Semail.split('@')[1];
         if(extention != "simad.edu.so") {
            alert('only Simad emails are allowed');
            return;
         } 

         $.ajax({
                type: 'post',
                url: '/send_verification',
                data: {
                  email:Semail
                },
                dataType: "json",
                success: function (res) {
                  console.log(res);
                  if(res.success) {
                     $('#email').val("");
                    $('#conf_ver_code').val("");
                    $('#email').val(res.email);
                    $('#conf_ver_code').val(res.codee);
                    $('#email_div').hide();
                    $('#verifcation_div').show();
                    $('#regiser_form_div').hide();
                  }else {
                  Swal.fire({
                            title: res.message,
                            icon: 'error',
                            confirmButtonText: 'OK',
                        }).then(_ => {
                           window.location.href = "/"
                        })

                  }
                }
            });
       }
  
       function confrim_verfication() {
         var in_code = $('#ver_code').val();
         var accutual_code = $('#conf_ver_code').val();


         console.log("the input code is: " + in_code + " The acctual code is: " + accutual_code);
         if(in_code.length != 6) {
            $("#messageee").val("Incorrect the code should be 6 digits")
            return;
         }

         if(in_code != accutual_code) {
            $("#messageee").val("Incorrect")
            return;
         }else {
            $('#email_div').hide();
            $('#verifcation_div').hide();
            $('#regiser_form_div').show();
         }
       }
  
  </script>

  </body>
</html>